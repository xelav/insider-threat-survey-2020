---
title: "Обзор по методам обнаружения инсайдерского поведения по пользовательскому поведению"
date: "Октябрь 2020"
author: "Валентин Александров, 620 группа"
mainfont: "Times New Roman"
mathfont: "Cambria Math"
bibliography: survey.bib
header-includes: |
    \usepackage{amsmath}
---

## Введение

Обнаружение инсайдерских угроз является очень трудной задачей в силу того, что инсайдеры для злонамеренных действий используют доверенный им доступ, что позволяет им с относительной легкостью обходить системы защиты информации.

Существует ряд технологий, для решения проблемы инсайдерских угроз:

- **DLP** (Data Loss Prevention) – предотвращение утечек с помощью анализа потоков данных, пересекающих периметр информационной системы
- **SIEM** (Security Information and Event Management) – анализ в реальном времени событий безопасности
- **IAM** (Identity and Access Management) – управление учетными данными пользователей, системами контроля и управления доступом
- **UBA** (User Behavior Analytics) – анализ действий пользователя и принятие решения на основе исторических данных

DLP, SIEM и IAM системы способны бороться с инсайдерами только на самом последнем этапе утечки данных, когда инсайдер пытается провести эксфильтрацию данных. При этом, до этого момента инсайдер проходит стадии подготовки утечки, которая может длиться месяцами и в течение этого этапа инсайдер проявляет аномальное поведение. Поэтому существует отдельный класс решений UBA, который направлен на анализ поведения пользователей и способны обнаруживать ранние признаки утечки информации.

Под поведенческой информацией понимается совокупность данных, которые описывают:

- Контекст – структурированные данные, описывающие атрибуты операций, которые пользователь выполняет с документами;
- Контент – неструктурированные данные в виде содержимого документов, ассоциированные с операциями пользователя.

## Обзор

Данную задачу можно условно разбить на две подзадачи: получение представление пользовательского поведения и классификация поведения на основе полученных представлений. Представление пользовательского поведения включает в себя выбор данных и процесс предобработки.

### Методы представления пользовательского поведения

В [@leEvaluatingInsiderThreat2018] представлен подход представления данных для последющего анализа, который заключаются в использовании как _последовательных_ данных (последовательность действий конкретного пользователя за некоторый период времени), так и _численных_ данных. Численные данные в данной работе делятся на пользовательские и данные о действиях. Пользовательские данные в наборе данных CERT представлены информацией о роли пользователя в подразделении, его отделе и психометрике. Данные о действиях получаются подсчетом количества совершенных действий одной категории за рассматриваемый промежуток времени. Контентные данные набора данных CERT не были рассмотрены по силу синтетической природы набора данных.

Архитектуры рекуррентных сетей изначально предполагают работу только с последовательными данными. Чтобы совместить последовательные и численные данные можно использовать подход предложенный в [@karpathyDeepVisualSemanticAlignments2015]. В данной статье решалась задача автоматической аннотации изображений, которая состоит в выделением некоторых участков изображения с различными объектами и генерация текстового описания объеков в этих участках. Для генерации текста использовалась архитектура RNN, в которой начальное состояние скрытых слоев зависит от информационного вектора о соответствующем участке изображения. Таким образом, все состояния рекуррентной сети обусловлены содержанием изображения. Этот подход успешно решал поставленную задачу.
Нетрудно расширить этот подход для произвольного числового вектора $\overrightarrow{x}$, который также называется _условным_. Мы можем преобразовать условный вектор так, чтобы он совпадал по размеру с вектором скрытого состояния рекуррентной сети $\overrightarrow{h}$. Для этого достаточно применить следующее простое преобразование:

$$\overrightarrow(h_0) = W\overrightarrow(x) + \overrightarrow(b)$$

,где $W$ и $\overrightarrow(b)$ являются обучаемыми параметрами. Затем, полученным вектором можно инициализировать скрытое состояние рекуррентой сети. Процесс повторяется для каждой обрабатываемой рекуррентной сетью последовательностью.

В статье [@leAnalyzingDataGranularity2020b] на наборе данных сравниваются модели с различными рассматривамыми периодами для каждого пользователя: день, неделя и пользовательская сессия. Для данного периода собирались числовые данные о частоте событий и их статистические признаки, такие как среднее, медиана и стандартное отклонение. В результате исследования модели, которые были обучены на полных пользовательских сессиях дали лучший результат.



### Методы классификации инсайдерского поведения

С представлением модели BERT [@devlinBERTPretrainingDeep2019], модели, основанные на механизме Attention стали де-факто новым эталоном качества в сфере обработки естественных языков. Attention позволяет нейронной сети самостоятельно перевзвесить элементы последовательности, выделяя таким образом наиболее важные элементы.  Вычисления в Attention-слое следующие:

$$
\mathbf{u_t} =  \tanh (\mathbf{W_a}\mathbf{h_t}+\mathbf{b_a})

\alpha_t =  \frac{\exp (\mathbf{u_t^T}\mathbf{u_a})}{\sum_i \exp (\mathbf{u_i^T}\mathbf{u_a}})

\mathbf{v} =  \sum_t \alpha_t\mathbf{h_t}
$$
где $\mathbf{W_a}$ - обучаемая матрица параметров, $\mathbf{u_a}$ - обучаемый вектор контекста, $\mathbf{h_t}$ t-ый выход из LSTM-слоя.
Полученный вектор $v$ подается на вход Softmax классификатору:
$$
p(\hat{y}=k | \mathbf{v}) = \frac{\exp(\mathbf{W_k^T}\mathbf{v} + \mathbf{b_k})}{\sum^K_{i=1} \exp(\mathbf{W_i^T}\mathbf{v} + \mathbf{b_i})}
$$
где, $\hat{y}$ - предсказанный класс, $K$ - количество классов, $\mathbf{W_k}$ и $\mathbf{b_k}$ - обучаемые параметры для k-ого класса.

В работе [@yuanAttentionBasedLSTMInsider2019] предложен способ класификации инсайдерского поведения на основе нейронной сети с LSTM для извлечения последовательной информации и Attention-слоем для классификации. При сравнении с базовой моделью без Attention-слоя, усложненная модель показала лучший результат на наборе данных CERT. Это указывает на то, что Attention-слой имеет потенциал для использовании и в задаче обнаружении инсайдеров.

## Библиография